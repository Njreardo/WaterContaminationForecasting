# WaterContaminationForecasting
Here I took LA as an example on how to use data and AI to predict the levels of contamination in water.

# Los Angeles Water Quality Analysis and Forecasting

	Countries all over the worlds are concerned about water contamination. They’re doing whatever they can to help reduce the contamination while, at the same time, corporations are delegated certain amounts of contamination that they are allowed to put in our water. Here, in Michigan, we’ve seen a major crisis, often called “genocide”, in one of our major cities, Flint. The politicians, for whatever reason, decided that it would be a good idea to change the water to Flint from a verified, safe source such as the Great Lakes, to an obviously heavily contaminated water source, the Flint River. This small change had a large impact and has killed many people while leaving others, especially children, with lifelong ailments. People in Flint don’t even shower with the water they get, they literally use donated bottles of water to keep themselves clean.
	This, being the main example known to the US throughout history, is simply unacceptable. Individuals, companies, and data scientists around the world are now making it their mission to constantly measure the contamination in their water sources literally as it flows. I had the unique chance to take a peek inside of the mind of one of these people and there is nothing like what he is trying to pull off at this time. Actually, his idea is quite simple. He wants to put IoT (Internet of Things) sensors into our water streams, analyze the data, and have a dashboard so that people can see, in real-time, what they are dealing with when it comes to keeping our water clean. This system will also serve as an alert to that end.
	Keeping our water clean has been on the minds of many people for centuries now but with little success. If you look at India, the river Ganges is notoriously known as the most polluted source of water on the planet. They are literally throwing all of their waste into that water including, but not limited to, excrement and chemicals. The odd thing is that they consider that river, with how filthy it is, a source of great blessing. This is just one example of a myriad of examples on how governments, politicians, businessmen and women, and people in general, lack the mindfulness of protecting one of our most basic needs.
	We need water; that much is certain. The problem is that our water, although it may help with dehydration at the onset, may contain contamination that will lead to adverse health effects including, but not limited to, gastrointestinal illness, reproductive problems, and neurological disorders. Also, infants, young children, pregnant women, the elderly, and people whose immune systems are compromised because of AIDS, chemotherapy, or transplant medications, may be especially susceptible to illness from some contaminants.[1] It is also a known fact now that individuals who drink contaminated water have a lower IQ than average. Something has to be done.
	The contamination of water in India is so bad that the numbers come in at 70%. 70% of fresh water in India, in the ground or on the surface, is contaminated.[2] This problem needs to be solved. Nearly 700,000 infants die every year in India because of water contamination.[3] I think that by taking a step towards identifying the problem then we can start addressing the issues where they start. Now, the data that I am working with is not directly related to India, but it is data that is available [4] on water contamination nonetheless.
	I don’t know about you but I want to live for a while. I want to live until there’s no more curiosity to have, no more future to look forward to, and nothing more that I can do that will excite me. I want to live an abnormally long life and I take steps to do that every day. On the other hand, there are people that just don’t care about your wants and even your basic needs. It is for that reason that I have chosen to apply Data Science to this area in particular.
	It turns out that we have the ability to predict, within a 10% margin of error or even better, how contaminated our water will be. This is not a surprising finding either. AI (Artificial Intelligence), ML (Machine Learning), and DL (Deep Learning) can easily identify these patterns in the data and make solid, foundational predictions as to what we can expect from our sources of water. Knowing the source of the problem is, in my opinion, the first step towards taking action to solve this issue and AI is available for us to help with that.
	Okay, now on to the more technical details. I like to use multiple models and pit them against each other to find where one succeeds and the others falter. In this case I found that training a Neural Network for 15 epochs produced some great results. However, it did not produce superior results to another method called Extra Tree’s. Extra Tree’s has been one of my favorite ML models for a very long time now. It just seems to outperform the others when you are using brute-force coding most of the time (as opposed to using cloud services such as AWS and Azure).
	I typically like to look at multiple metrics when evaluating a model. Here, I used the MAPE (Mean Absolute Percentage Error)[5] as well as R2 (the coefficient of determination or, in other words, how well the features help in defining the target)[6]. By using these metrics we can get a good idea to the inner workings of the model. That’s not to say that we have a good explanation of what’s going on because, as of now, the interpretability of the algorithms we use is not very good, but it is saying that the algorithm is working pretty good given the objective.
	To take a look, and understand the model I’ve chosen to move forward with, I will show you a picture of what it looks like (regardless of the problem of interpretability). Extra Tree’s can be visualized as looking like so.
 
	The image above is an example of what the idea behind the algorithm looks like. It is hierarchical and determines, with a good degree of accuracy, what you should expect as the output. This is in contrast to Neural Networks, like the one that I trained, which looks like the following.
 
	As you can see, there are differences between the two, one of which being that a Neural Network is comprised of units that are all intertwined like what you would expect to see in the brain (although I do believe that it may not be a perfectly analogous). Many people believe that, given enough computational power as well as a large enough network of these neurons, we will see that, not only can it infer what any other model may be but, it will ultimately do it better. We do see evidence that that may be the case but the demands that Neural Networks have on our current CPU’s and even our best GPU’s are very high and very costly.
	In my case, I used a small neural network consisting of just 2 hidden layers and 1 output neuron because, when you’re working with Regression, this task requires one output neuron. In the case of the Neural Network I trained, the MAPE came out to about an 88% margin of error while ML (Extra Tree’s) have a 10% margin of error. Now, I could train a larger network and see how that goes but, for purposes of simplicity and computational power, I will be using the ExtraTree’s Regressor.
	Having a 10% margin of error is great because that says that typically we can look at the source of the water and believe that the level of contamination is within that 10% range of the prediction. So, when we are dealing with a contamination metric of 700, that means that you can trust that the actual contamination is likely to be as high as 770 and as low as 630. This doesn’t mean that there will not be outliers, which also affect the MAPE, but it does mean that we can have confidence in our predictions. (Note: there were no outliers in this data)
	Once knowing this information, we can start to make tweaks to what we currently know about our water systems. We can start testing our hypotheses as to how we can reduce the amount of contamination, measure that contamination, and conclude whether it is better than normal or not. Through the use of IoT devices we should be able to do this relatively quickly. Then, once we have a good idea of what works and what doesn’t as well as where we should be getting our water from, we can retrain our models and see what the outcome is overall. Did it get worse? Better? Or is it still where it used to be?





References
1.	CDC.gov, 2/16/2022 https://www.cdc.gov/healthywater/drinking/public/water_diseases.html
2.	Circleofblue.org, 2/16/2022 https://www.circleofblue.org/2018/india/toxic-water-toxic-crops-indias-public-health-time-bomb/#:~:text=According%20to%20the%20latest%20assessment,the%20surface%20%E2%80%93%20also%20is%20contaminated.
3.	Weather.com, 2/16/2022 https://weather.com/en-IN/india/pollution/news/2019-12-20-23-lakh-premature-pollution-deaths
4.	Kaggle.com, 2/16/2022 https://www.kaggle.com/peternooteboom/los-angeles-water-quality
5.	“How to Calculate MAPE in Python”, 2/16/2022 https://www.statology.org/mape-python/
6.	Investopedia, 2/16/2022 https://www.investopedia.com/terms/r/r-squared.asp#:~:text=R%2Dsquared%20(R2),variables%20in%20a%20regression%20model.

![image](https://user-images.githubusercontent.com/1999537/156678159-681226bd-33d4-4d4b-b1d8-420d51bbc3e9.png)
